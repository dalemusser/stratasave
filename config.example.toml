# Stratasave Configuration Example
# Copy this file to config.toml and update values for your environment.
#
# Configuration can also be set via:
#   - Environment variables: STRATASAVE_<KEY> (e.g., STRATASAVE_MONGO_URI)
#   - Command-line flags: --<key> (e.g., --mongo_uri)
#
# Precedence (highest wins): flags > env vars > config file > defaults

# =============================================================================
# RUNTIME ENVIRONMENT
# =============================================================================

# Environment mode: "dev" or "prod"
# In prod mode, Let's Encrypt uses production servers
env = "dev"

# Log level: debug, info, warn, error
log_level = "debug"

# =============================================================================
# HTTP SERVER
# =============================================================================

# HTTP port (default: 8080)
http_port = 8080

# HTTPS port (default: 443, used when use_https = true)
https_port = 443

# Enable HTTPS (requires TLS configuration below)
use_https = false

# HTTP server timeouts
read_timeout = "15s"
read_header_timeout = "10s"
write_timeout = "60s"
idle_timeout = "120s"
shutdown_timeout = "15s"

# Maximum request body size in bytes (default: 2MB, 0 = no limit, -1 = reject all)
max_request_body_bytes = 2097152

# =============================================================================
# TLS / HTTPS (only needed if use_https = true)
# =============================================================================

# Option 1: Let's Encrypt (automatic certificates)
# use_lets_encrypt = true
# lets_encrypt_email = "admin@example.com"
# lets_encrypt_cache_dir = "letsencrypt-cache"
# domain = "example.com"
# For wildcard certs, use dns-01 challenge:
# lets_encrypt_challenge = "dns-01"
# route53_hosted_zone_id = "Z1234567890ABC"
# domains = '["example.com", "*.example.com"]'

# Option 2: Manual TLS (your own certificates)
# cert_file = "/path/to/cert.pem"
# key_file = "/path/to/key.pem"

# =============================================================================
# DATABASE
# =============================================================================

# MongoDB connection URI
mongo_uri = "mongodb://localhost:27017"

# MongoDB database name
mongo_database = "stratasave"

# Connection pool settings
mongo_max_pool_size = 100
mongo_min_pool_size = 10

# Database connection timeout
db_connect_timeout = "10s"

# Index creation timeout on startup
index_boot_timeout = "120s"

# =============================================================================
# SESSIONS & SECURITY
# =============================================================================

# Session signing key (MUST be changed in production, 32+ characters)
session_key = "dev-only-change-me-please-0123456789ABCDEF"

# Session cookie name
session_name = "stratasave-session"

# Session cookie domain (blank = current host only)
# For subdomains, use ".example.com" (with leading dot)
session_domain = ""

# Session duration (e.g., 24h, 720h for 30 days)
session_max_age = "24h"

# CSRF token signing key (MUST be changed in production, 32+ characters)
csrf_key = "dev-only-csrf-key-please-change-0123456789"

# =============================================================================
# IDLE LOGOUT
# =============================================================================

# Enable automatic logout after idle time
idle_logout_enabled = false

# Idle timeout duration before logout
idle_logout_timeout = "30m"

# Warning time before idle logout
idle_logout_warning = "5m"

# =============================================================================
# RATE LIMITING
# =============================================================================

# Enable rate limiting for login attempts
rate_limit_enabled = true

# Max failed login attempts before lockout
rate_limit_login_attempts = 5

# Time window for counting failed attempts
rate_limit_login_window = "15m"

# Lockout duration after exceeding limit
rate_limit_login_lockout = "15m"

# =============================================================================
# API ACCESS
# =============================================================================

# API key for external API access (leave empty to disable)
# When set, allows Bearer token authentication for API endpoints
api_key = ""

# =============================================================================
# FILE STORAGE
# =============================================================================

# Storage backend: "local" or "s3"
storage_type = "local"

# --- Local Storage ---
# Path for uploaded files
storage_local_path = "./uploads"

# URL prefix for serving files
storage_local_url = "/files"

# --- S3 Storage (uncomment to use) ---
# storage_type = "s3"
# storage_s3_region = "us-east-1"
# storage_s3_bucket = "my-bucket"
# storage_s3_prefix = "uploads/"

# --- CloudFront CDN (optional, for S3) ---
# storage_cf_url = "https://d1234567890.cloudfront.net"
# storage_cf_keypair_id = "APKAXXXXXXXXXXXXXXXX"
# storage_cf_key_path = "/path/to/cloudfront-private-key.pem"

# =============================================================================
# EMAIL / SMTP
# =============================================================================

# SMTP server settings
mail_smtp_host = "localhost"
mail_smtp_port = 1025
mail_smtp_user = ""
mail_smtp_pass = ""

# From address for outgoing emails
mail_from = "noreply@example.com"
mail_from_name = "Stratasave"

# Base URL for email links (magic links, password reset, etc.)
base_url = "http://localhost:8080"

# Email verification code/link expiry
email_verify_expiry = "10m"

# =============================================================================
# GOOGLE OAUTH (optional)
# =============================================================================

# Google OAuth2 credentials
# Get these from: https://console.cloud.google.com/apis/credentials
google_client_id = ""
google_client_secret = ""

# =============================================================================
# AUDIT LOGGING
# =============================================================================

# Auth event logging: "all" (db+log), "db", "log", or "off"
audit_log_auth = "all"

# Admin event logging: "all" (db+log), "db", "log", or "off"
audit_log_admin = "all"

# =============================================================================
# ADMIN SEEDING
# =============================================================================

# Email of admin user to create on startup (leave empty to disable)
seed_admin_email = ""

# Name of admin user to create on startup
seed_admin_name = "Admin"

# =============================================================================
# COMPRESSION
# =============================================================================

# Enable HTTP response compression
enable_compression = true

# Compression level (1 = fastest, 9 = best compression)
compression_level = 5

# =============================================================================
# CORS (Cross-Origin Resource Sharing)
# =============================================================================

# Enable CORS headers
enable_cors = false

# Allowed origins (JSON array or comma-separated in env var)
# cors_allowed_origins = '["https://example.com", "https://app.example.com"]'

# Allowed HTTP methods
# cors_allowed_methods = '["GET", "POST", "PUT", "DELETE"]'

# Allowed request headers
# cors_allowed_headers = '["Accept", "Authorization", "Content-Type"]'

# Headers exposed to the browser
# cors_exposed_headers = '["Link"]'

# Allow credentials (cookies, authorization headers)
cors_allow_credentials = false

# Preflight cache duration in seconds
cors_max_age = 0

# =============================================================================
# SECURITY HEADERS
# =============================================================================

# Enable security headers middleware (enabled by default)
# These headers protect against common web attacks like clickjacking, XSS, etc.
enable_security_headers = true

# X-Frame-Options: Controls iframe embedding
# Values: "DENY" (never), "SAMEORIGIN" (same origin only)
x_frame_options = "SAMEORIGIN"

# X-Content-Type-Options: Prevents MIME type sniffing
# Should always be "nosniff" unless you have a specific reason
x_content_type_options = "nosniff"

# Referrer-Policy: Controls referrer information sent with requests
# Values: "no-referrer", "origin", "strict-origin-when-cross-origin"
referrer_policy = "strict-origin-when-cross-origin"

# X-XSS-Protection: Browser XSS filter (legacy, for older browsers)
# Values: "0" (disable), "1" (enable), "1; mode=block"
x_xss_protection = "1; mode=block"

# Strict-Transport-Security (HSTS): Forces HTTPS
# Only sent for HTTPS requests. Set to 0 to disable.
hsts_max_age = 31536000  # 1 year in seconds

# Include subdomains in HSTS policy
hsts_include_subdomains = true

# Enable HSTS preload (only if submitted to hstspreload.org)
hsts_preload = false

# Content-Security-Policy: Powerful XSS prevention (application-specific)
# Leave empty to not set. Example: "default-src 'self'; script-src 'self' 'unsafe-inline'"
content_security_policy = ""

# Permissions-Policy: Controls browser feature access
# Leave empty to not set. Example: "geolocation=(), microphone=(), camera=()"
permissions_policy = ""
